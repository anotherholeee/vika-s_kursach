# Описание классов системы управления общественным транспортом

## Классы транспортных средств

### 1. Класс Vehicle

Данный класс является базовым классом для всех транспортных средств в системе. Предназначен для представления общего функционала транспорта независимо от типа. Обеспечивает базовую функциональность для идентификации и сериализации транспортных средств.

**Поля:**

- `string type` – поле для хранения типа транспортного средства (Автобус, Трамвай, Троллейбус);
- `string model` – поле для хранения модели транспортного средства;
- `string licensePlate` – поле для хранения государственного номера транспортного средства;

**Методы:**

- `Vehicle(const string& t, const string& m, const string& lp)` – конструктор с параметрами;
- `virtual ~Vehicle()` – виртуальный деструктор;
- `string getInfo() const` – метод получения полной информации о транспортном средстве;
- `string getType() const` – метод получения типа транспортного средства;
- `string getModel() const` – метод получения модели транспортного средства;
- `string getLicensePlate() const` – метод получения государственного номера;
- `virtual string serialize() const` – виртуальный метод для преобразования в строку для записи в файл;
- `static shared_ptr<Vehicle> deserialize(const string& data)` – статический метод для загрузки из строки файла;

---

### 2. Класс ElectricTransport

Данный класс является промежуточным классом для электрического транспорта в системе. Наследуется от класса Vehicle и представляет транспортные средства, работающие на электричестве (трамваи и троллейбусы). Обеспечивает хранение и обработку характеристик электрического транспорта.

**Поля:**

- `int capacity` – поле для хранения вместимости пассажиров;
- `double voltage` – поле для хранения напряжения питания в вольтах;

**Методы:**

- `ElectricTransport(const string& t, const string& m, const string& lp, int cap = 50, double volt = 600.0)` – конструктор с параметрами;
- `int getCapacity() const` – метод получения вместимости пассажиров;
- `void setCapacity(int cap)` – метод изменения вместимости пассажиров;
- `double getVoltage() const` – метод получения напряжения питания;
- `void setVoltage(double volt)` – метод изменения напряжения питания;
- `string serialize() const override` – переопределенный метод для преобразования в строку для записи в файл;

---

### 3. Класс FuelTransport

Данный класс является промежуточным классом для топливного транспорта в системе. Наследуется от класса Vehicle и представляет транспортные средства, работающие на топливе (автобусы). Обеспечивает хранение и обработку характеристик топливного транспорта.

**Поля:**

- `int capacity` – поле для хранения вместимости пассажиров;
- `string fuelType` – поле для хранения типа топлива (бензин, дизель, газ);

**Методы:**

- `FuelTransport(const string& t, const string& m, const string& lp, int cap = 50, const string& fuel = "дизель")` – конструктор с параметрами;
- `int getCapacity() const` – метод получения вместимости пассажиров;
- `void setCapacity(int cap)` – метод изменения вместимости пассажиров;
- `string getFuelType() const` – метод получения типа топлива;
- `void setFuelType(const string& fuel)` – метод изменения типа топлива;
- `string serialize() const override` – переопределенный метод для преобразования в строку для записи в файл;

---

### 4. Класс Bus

Данный класс является наследником класса FuelTransport и представляет автобус в системе. Обеспечивает создание и управление автобусами с заданными характеристиками.

**Методы:**

- `Bus(const string& m, const string& lp, int cap = 50, const string& fuel = "дизель")` – конструктор с параметрами;

---

### 5. Класс Tram

Данный класс является наследником класса ElectricTransport и представляет трамвай в системе. Обеспечивает создание и управление трамваями с заданными характеристиками.

**Методы:**

- `Tram(const string& m, const string& lp, int cap = 100, double volt = 600.0)` – конструктор с параметрами;

---

### 6. Класс Trolleybus

Данный класс является наследником класса ElectricTransport и представляет троллейбус в системе. Обеспечивает создание и управление троллейбусами с заданными характеристиками.

**Методы:**

- `Trolleybus(const string& m, const string& lp, int cap = 50, double volt = 600.0)` – конструктор с параметрами;

---

## Классы данных

### 7. Класс Driver

Данный класс представляет водителя транспортного средства в системе. Обеспечивает хранение и обработку персональных данных водителя.

**Поля:**

- `string firstName` – поле для хранения имени водителя;
- `string lastName` – поле для хранения фамилии водителя;
- `string middleName` – поле для хранения отчества водителя;

**Методы:**

- `Driver(const string& fname, const string& lname, const string& mname = "")` – конструктор с параметрами;
- `string getFullName() const` – метод получения полного имени водителя;
- `string getFirstName() const` – метод получения имени водителя;
- `string getLastName() const` – метод получения фамилии водителя;
- `string getMiddleName() const` – метод получения отчества водителя;
- `bool operator==(const Driver& other) const` – перегрузка оператора сравнения на равенство;
- `string serialize() const` – метод преобразования в строку для записи в файл;
- `static shared_ptr<Driver> deserialize(const string& data)` – статический метод для загрузки из строки файла;

---

### 8. Класс Stop

Данный класс представляет остановку общественного транспорта в системе. Обеспечивает хранение и обработку данных об остановках.

**Поля:**

- `int id` – поле для хранения уникального идентификатора остановки;
- `string name` – поле для хранения названия остановки;

**Методы:**

- `Stop(int stopId, string stopName)` – конструктор с параметрами;
- `int getId() const` – метод получения идентификатора остановки;
- `string getName() const` – метод получения названия остановки;
- `bool operator==(const Stop& other) const` – перегрузка оператора сравнения на равенство;
- `string serialize() const` – метод преобразования в строку для записи в файл;
- `static Stop deserialize(const string& data)` – статический метод для загрузки из строки файла;

---

### 9. Класс Route

Данный класс представляет маршрут общественного транспорта в системе. Обеспечивает хранение и обработку данных о маршрутах, включая список остановок и дни недели работы.

**Поля:**

- `int number` – поле для хранения номера маршрута;
- `string vehicleType` – поле для хранения типа транспортного средства маршрута;
- `string startStop` – поле для хранения начальной остановки маршрута;
- `string endStop` – поле для хранения конечной остановки маршрута;
- `vector<string> allStops` – поле для хранения списка всех остановок маршрута;
- `set<int> weekDays` – поле для хранения дней недели работы маршрута (1-понедельник, 7-воскресенье);

**Методы:**

- `Route(int num, const string& vType, const vector<string>& stops, const set<int>& days = {1,2,3,4,5,6,7})` – конструктор с параметрами;
- `bool containsStop(const string& stop) const` – метод проверки наличия остановки в маршруте;
- `int getStopPosition(const string& stop) const` – метод получения позиции остановки в маршруте;
- `bool isStopBefore(const string& stopA, const string& stopB) const` – метод проверки, находится ли остановка A перед остановкой B;
- `int getNumber() const` – метод получения номера маршрута;
- `string getVehicleType() const` – метод получения типа транспортного средства;
- `string getStartStop() const` – метод получения начальной остановки;
- `string getEndStop() const` – метод получения конечной остановки;
- `const vector<string>& getAllStops() const` – метод получения списка всех остановок;
- `const set<int>& getWeekDays() const` – метод получения дней недели работы;
- `bool operatesOnDay(int day) const` – метод проверки работы маршрута в указанный день недели;
- `string serialize() const` – метод преобразования в строку для записи в файл;
- `static shared_ptr<Route> deserialize(const string& data)` – статический метод для загрузки из строки файла;

---

### 10. Класс Time

Данный класс представляет время в системе. Обеспечивает хранение и обработку времени в формате часов и минут, а также выполнение арифметических операций с временем.

**Поля:**

- `int hours` – поле для хранения часов (0-23);
- `int minutes` – поле для хранения минут (0-59);

**Методы:**

- `explicit Time(int h = 0, int m = 0)` – конструктор с параметрами;
- `explicit Time(const string& timeStr)` – конструктор из строки формата "ЧЧ:ММ";
- `int getTotalMinutes() const` – метод получения общего количества минут с начала суток;
- `int getHours() const` – метод получения часов;
- `int getMinutes() const` – метод получения минут;
- `bool operator<(const Time& other) const` – перегрузка оператора сравнения меньше;
- `bool operator<=(const Time& other) const` – перегрузка оператора сравнения меньше или равно;
- `bool operator>(const Time& other) const` – перегрузка оператора сравнения больше;
- `bool operator>=(const Time& other) const` – перегрузка оператора сравнения больше или равно;
- `bool operator==(const Time& other) const` – перегрузка оператора сравнения на равенство;
- `bool operator!=(const Time& other) const` – перегрузка оператора сравнения на неравенство;
- `Time operator+(int minutesToAdd) const` – перегрузка оператора сложения времени с минутами;
- `Time operator-(int minutesToSubtract) const` – перегрузка оператора вычитания минут из времени;
- `int operator-(const Time& other) const` – перегрузка оператора вычитания времени (возвращает разницу в минутах);
- `friend ostream& operator<<(ostream& os, const Time& time)` – перегрузка оператора вывода времени на экран;
- `friend istream& operator>>(istream& is, Time& time)` – перегрузка оператора ввода времени с консоли;
- `string serialize() const` – метод преобразования в строку для записи в файл;
- `static Time deserialize(const string& data)` – статический метод для загрузки из строки файла;

**Приватные методы:**

- `void normalize(int totalMinutes)` – метод нормализации времени (приведение к диапазону 0-1439 минут);

---

### 11. Класс Trip

Данный класс представляет рейс транспортного средства в системе. Обеспечивает хранение и обработку данных о рейсах, включая маршрут, транспортное средство, водителя, время отправления и расписание прибытия на остановки.

**Поля:**

- `int tripId` – поле для хранения уникального идентификатора рейса;
- `shared_ptr<Route> route` – указатель на маршрут рейса;
- `shared_ptr<Vehicle> vehicle` – указатель на транспортное средство;
- `shared_ptr<Driver> driver` – указатель на водителя;
- `Time startTime` – поле для хранения времени отправления;
- `map<string, Time> schedule` – поле для хранения расписания прибытия на остановки (остановка -> время прибытия);
- `int weekDay` – поле для хранения дня недели рейса (1-понедельник, 7-воскресенье);

**Методы:**

- `Trip(int id, shared_ptr<Route> r, shared_ptr<Vehicle> v, shared_ptr<Driver> d, const Time& start, int day = 1)` – конструктор с параметрами;
- `void setArrivalTime(const string& stop, const Time& time)` – метод установки времени прибытия на остановку;
- `Time getArrivalTime(const string& stop) const` – метод получения времени прибытия на остановку;
- `bool hasStop(const string& stop) const` – метод проверки наличия остановки в расписании;
- `int getTripId() const` – метод получения идентификатора рейса;
- `shared_ptr<Route> getRoute() const` – метод получения маршрута рейса;
- `shared_ptr<Vehicle> getVehicle() const` – метод получения транспортного средства;
- `shared_ptr<Driver> getDriver() const` – метод получения водителя;
- `Time getStartTime() const` – метод получения времени отправления;
- `const map<string, Time>& getSchedule() const` – метод получения расписания прибытия;
- `int getWeekDay() const` – метод получения дня недели;
- `Time getEstimatedEndTime() const` – метод получения расчетного времени окончания рейса;
- `string serialize() const` – метод преобразования в строку для записи в файл;
- `static shared_ptr<Trip> deserialize(const string& data, TransportSystem* system = nullptr)` – статический метод для загрузки из строки файла;

---

### 12. Класс Journey

Данный класс представляет поездку с пересадками в системе. Обеспечивает хранение и обработку данных о маршруте поездки, состоящем из нескольких рейсов с пересадками между ними.

**Поля:**

- `vector<shared_ptr<Trip>> trips` – поле для хранения списка рейсов, составляющих поездку;
- `vector<string> transferPoints` – поле для хранения точек пересадки;
- `Time startTime` – поле для хранения времени начала поездки;
- `Time endTime` – поле для хранения времени окончания поездки;
- `int transferCount` – поле для хранения количества пересадок;

**Методы:**

- `Journey(const vector<shared_ptr<Trip>>& tripList, const vector<string>& transfers, Time start, Time end)` – конструктор с параметрами;
- `int getTotalDuration() const` – метод получения общей продолжительности поездки в минутах;
- `int getTransferCount() const` – метод получения количества пересадок;
- `Time getStartTime() const` – метод получения времени начала поездки;
- `Time getEndTime() const` – метод получения времени окончания поездки;
- `const vector<shared_ptr<Trip>>& getTrips() const` – метод получения списка рейсов;
- `const vector<string>& getTransferPoints() const` – метод получения точек пересадки;
- `void display() const` – метод вывода информации о поездке на экран;

---

## Классы системы

### 13. Класс TransportSystem

Данный класс представляет основную систему управления общественным транспортом. Обеспечивает хранение и управление всеми данными системы: маршрутами, рейсами, транспортными средствами, водителями и остановками. Реализует функционал поиска, планирования поездок и управления данными.

**Поля:**

- `vector<shared_ptr<Route>> routes` – поле для хранения списка маршрутов;
- `vector<shared_ptr<Trip>> trips` – поле для хранения списка рейсов;
- `vector<shared_ptr<Vehicle>> vehicles` – поле для хранения списка транспортных средств;
 `vector<shared_ptr<Driver>> drivers` – поле для хранения списка водителей;
- `DynamicArray<Stop> stops` – поле для хранения списка остановок;
- `unordered_map<int, string> stopIdToName` – поле для хранения соответствия идентификаторов остановок их названиям;
- `unordered_map<string, string> adminCredentials` – поле для хранения учетных данных администраторов;
- `JourneyPlanner journeyPlanner` – поле для планировщика поездок;
- `DriverSchedule driverSchedule` – поле для расписания водителей;
- `DataManager dataManager` – поле для менеджера данных;
- `CommandHistory commandHistory` – поле для истории команд;
- `unique_ptr<ArrivalTimeCalculationAlgorithm> arrivalTimeAlgorithm` – указатель на алгоритм расчета времени прибытия;
- `unique_ptr<RouteSearchAlgorithm> routeSearchAlgorithm` – указатель на алгоритм поиска маршрутов;

**Методы:**

- `TransportSystem()` – конструктор по умолчанию;
- `bool canUndo() const` – метод проверки возможности отмены последнего действия;
- `void undo()` – метод отмены последнего действия;
- `string getLastCommandDescription() const` – метод получения описания последней команды;
- `bool authenticateAdmin(const string& username, const string& password)` – метод аутентификации администратора;
- `void addAdmin(const string& username, const string& password)` – метод добавления администратора;
- `const unordered_map<string, string>& getAdminCredentials() const` – метод получения учетных данных администраторов;
- `void setAdminCredentials(const unordered_map<string, string>& creds)` – метод установки учетных данных администраторов;
- `void saveData()` – метод сохранения всех данных системы;
- `void loadData()` – метод загрузки всех данных системы;
- `vector<shared_ptr<Route>> findRoutes(const string& stopA, const string& stopB)` – метод поиска маршрутов между двумя остановками;
- `void getStopTimetable(int stopId, const Time& startTime, const Time& endTime)` – метод получения расписания остановки в указанном временном диапазоне;
- `void getStopTimetableAll(const string& stopName)` – метод получения полного расписания остановки;
- `void calculateArrivalTimes(int tripId, double averageSpeed)` – метод расчета времени прибытия на остановки для рейса;
- `ArrivalTimeCalculationAlgorithm* getArrivalTimeAlgorithm() const` – метод получения алгоритма расчета времени прибытия;
- `RouteSearchAlgorithm* getRouteSearchAlgorithm() const` – метод получения алгоритма поиска маршрутов;
- `void addRoute(shared_ptr<Route> route)` – метод добавления маршрута;
- `void addTrip(shared_ptr<Trip> trip)` – метод добавления рейса;
- `void addVehicle(shared_ptr<Vehicle> vehicle)` – метод добавления транспортного средства;
- `void addDriver(shared_ptr<Driver> driver)` – метод добавления водителя;
- `void addStop(const Stop& stop)` – метод добавления остановки;
- `void removeRoute(int routeNumber)` – метод удаления маршрута;
- `void removeTrip(int tripId)` – метод удаления рейса;
- `void displayAllRoutes() const` – метод вывода всех маршрутов;
- `void displayAllTrips() const` – метод вывода всех рейсов;
- `void displayAllVehicles() const` – метод вывода всех транспортных средств;
- `void displayAllStops() const` – метод вывода всех остановок;
- `const vector<shared_ptr<Trip>>& getTrips() const` – метод получения списка рейсов;
- `const vector<shared_ptr<Route>>& getRoutes() const` – метод получения списка маршрутов;
- `const vector<shared_ptr<Vehicle>>& getVehicles() const` – метод получения списка транспортных средств;
- `const DynamicArray<Stop>& getStops() const` – метод получения списка остановок;
- `const vector<shared_ptr<Driver>>& getDrivers() const` – метод получения списка водителей;
- `JourneyPlanner& getJourneyPlanner()` – метод получения планировщика поездок;
- `DriverSchedule& getDriverSchedule()` – метод получения расписания водителей;
- `shared_ptr<Driver> findDriverByName(const string& firstName, const string& lastName, const string& middleName = "") const` – метод поиска водителя по имени;
- `shared_ptr<Vehicle> findVehicleByLicensePlate(const string& licensePlate) const` – метод поиска транспортного средства по государственному номеру;
- `shared_ptr<Route> findRouteByNumber(int number) const` – метод поиска маршрута по номеру;
- `vector<shared_ptr<Trip>> getTripsThroughStop(const string& stopName) const` – метод получения всех рейсов, проходящих через указанную остановку;
- `string getStopNameById(int id) const` – метод получения названия остановки по идентификатору;
- `shared_ptr<Route> getRouteByNumber(int number)` – метод получения маршрута по номеру;
- `shared_ptr<Trip> getTripById(int id)` – метод получения рейса по идентификатору;
- `shared_ptr<Vehicle> getVehicleByLicensePlate(const string& licensePlate)` – метод получения транспортного средства по государственному номеру;
- `Stop getStopById(int id)` – метод получения остановки по идентификатору;
- `void addRouteDirect(shared_ptr<Route> route)` – прямой метод добавления маршрута (без команды);
- `void removeRouteDirect(int routeNumber)` – прямой метод удаления маршрута (без команды);
- `void addTripDirect(shared_ptr<Trip> trip)` – прямой метод добавления рейса (без команды);
- `void removeTripDirect(int tripId)` – прямой метод удаления рейса (без команды);
- `void addVehicleDirect(shared_ptr<Vehicle> vehicle)` – прямой метод добавления транспортного средства (без команды);
- `void removeVehicleDirect(const string& licensePlate)` – прямой метод удаления транспортного средства (без команды);
- `void addStopDirect(const Stop& stop)` – прямой метод добавления остановки (без команды);
- `void removeStopDirect(int stopId)` – прямой метод удаления остановки (без команды);
- `void addDriverDirect(shared_ptr<Driver> driver)` – прямой метод добавления водителя (без команды);
- `void removeDriverDirect(shared_ptr<Driver> driver)` – прямой метод удаления водителя (без команды);

---

### 14. Класс JourneyPlanner

Данный класс представляет планировщик поездок в системе. Обеспечивает поиск маршрутов между остановками с использованием различных алгоритмов. Реализует паттерн Facade для упрощения работы с алгоритмами поиска пути.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `unique_ptr<BFSAlgorithm> bfsAlgorithm` – указатель на алгоритм поиска в ширину;
- `unique_ptr<FastestPathAlgorithm> fastestAlgorithm` – указатель на алгоритм поиска самого быстрого пути;
- `unique_ptr<MinimalTransfersAlgorithm> minimalTransfersAlgorithm` – указатель на алгоритм поиска пути с минимальными пересадками;

**Методы:**

- `JourneyPlanner(TransportSystem* sys)` – конструктор с параметром;
- `vector<Journey> findJourneysWithTransfers(const string& startStop, const string& endStop, const Time& departureTime, int maxTransfers = 2) const` – метод поиска поездок с пересадками с учетом времени отправления;
- `vector<Journey> findAllJourneysWithTransfers(const string& startStop, const string& endStop, int maxTransfers = 2) const` – метод поиска всех поездок с пересадками;
- `Journey findFastestJourney(const string& startStop, const string& endStop, const Time& departureTime)` – метод поиска самой быстрой поездки;
- `Journey findJourneyWithLeastTransfers(const string& startStop, const string& endStop, const Time& departureTime)` – метод поиска поездки с минимальным количеством пересадок;
- `void displayJourney(const Journey& journey) const` – метод вывода информации о поездке на экран;

---

### 15. Класс DataManager

Данный класс представляет менеджер данных в системе. Обеспечивает сохранение и загрузку всех данных системы из файлов. Управляет файловыми операциями для остановок, транспортных средств, водителей, маршрутов, рейсов и учетных данных администраторов.

**Поля:**

- `string dataDirectory` – поле для хранения пути к директории с данными;

**Методы:**

- `DataManager(const string& dir = "data/")` – конструктор с параметром пути к директории;
- `void saveAllData(TransportSystem& system)` – метод сохранения всех данных системы;
- `void loadAllData(TransportSystem& system)` – метод загрузки всех данных системы;

**Приватные методы:**

- `void saveStops(TransportSystem& system)` – метод сохранения остановок;
- `void saveVehicles(TransportSystem& system)` – метод сохранения транспортных средств;
- `void saveDrivers(TransportSystem& system)` – метод сохранения водителей;
- `void saveRoutes(TransportSystem& system)` – метод сохранения маршрутов;
- `void saveTrips(TransportSystem& system)` – метод сохранения рейсов;
- `void saveAdminCredentials(TransportSystem& system)` – метод сохранения учетных данных администраторов;
- `void loadStops(TransportSystem& system)` – метод загрузки остановок;
- `void loadVehicles(TransportSystem& system)` – метод загрузки транспортных средств;
- `void loadDrivers(TransportSystem& system)` – метод загрузки водителей;
- `void loadRoutes(TransportSystem& system)` – метод загрузки маршрутов;
- `void loadTrips(TransportSystem& system)` – метод загрузки рейсов;
- `void loadAdminCredentials(TransportSystem& system)` – метод загрузки учетных данных администраторов;

---

### 16. Класс DriverSchedule

Данный класс представляет расписание водителей в системе. Обеспечивает управление назначением рейсов водителям и проверку соответствия рабочего времени водителей установленным ограничениям.

**Поля:**

- `unordered_map<shared_ptr<Driver>, vector<shared_ptr<Trip>>> driverTrips` – поле для хранения соответствия водителей их рейсам;
- `const int MAX_WORKING_HOURS` – константа максимального рабочего времени водителя в минутах (12 часов);

**Методы:**

- `void assignTripToDriver(shared_ptr<Driver> driver, shared_ptr<Trip> trip)` – метод назначения рейса водителю;
- `void removeTripFromDriver(shared_ptr<Driver> driver, int tripId)` – метод удаления рейса у водителя;
- `bool isDriverAvailable(shared_ptr<Driver> driver, const Time& startTime, const Time& endTime) const` – метод проверки доступности водителя в указанном временном диапазоне;
- `bool checkWorkingHoursCompliance(shared_ptr<Driver> driver) const` – метод проверки соответствия рабочего времени водителя установленным ограничениям;
- `vector<shared_ptr<Trip>> getDriverTrips(shared_ptr<Driver> driver) const` – метод получения всех рейсов водителя;
- `int getTotalWorkingMinutes(shared_ptr<Driver> driver) const` – метод получения общего рабочего времени водителя в минутах;

---

## Классы команд (паттерн Command)

### 17. Класс Command

Данный класс представляет базовый класс команды в паттерне Command. Используется для реализации механизма отмены и повтора действий в системе. Все команды наследуются от этого класса.

**Методы:**

- `virtual ~Command()` – виртуальный деструктор;
- `virtual void execute() = 0` – чистая виртуальная функция выполнения команды;
- `virtual void undo() = 0` – чистая виртуальная функция отмены команды;
- `virtual string getDescription() const = 0` – чистая виртуальная функция получения описания команды;

---

### 18. Класс CommandHistory

Данный класс представляет менеджер истории команд для реализации механизма отмены действий. Хранит последовательность выполненных команд и позволяет отменять их.

**Поля:**

- `vector<unique_ptr<Command>> history` – контейнер для хранения истории команд;
- `size_t currentIndex` – индекс текущей позиции в истории;
- `static const size_t MAX_HISTORY_SIZE` – максимальный размер истории (100);

**Методы:**

- `void executeCommand(unique_ptr<Command> cmd)` – метод выполнения команды и добавления в историю;
- `bool canUndo() const` – метод проверки возможности отмены;
- `void undo()` – метод отмены последней команды;
- `void clear()` – метод очистки истории;
- `string getLastCommandDescription() const` – метод получения описания последней команды;

---

### 19. Класс AddRouteCommand

Данный класс представляет команду добавления маршрута в систему. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Route> route` – указатель на добавляемый маршрут;

**Методы:**

- `AddRouteCommand(TransportSystem* sys, shared_ptr<Route> r)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 20. Класс RemoveRouteCommand

Данный класс представляет команду удаления маршрута из системы. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Route> route` – указатель на удаляемый маршрут;
- `int routeNumber` – номер удаляемого маршрута;

**Методы:**

- `RemoveRouteCommand(TransportSystem* sys, int num)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 21. Класс AddTripCommand

Данный класс представляет команду добавления рейса в систему. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Trip> trip` – указатель на добавляемый рейс;

**Методы:**

- `AddTripCommand(TransportSystem* sys, shared_ptr<Trip> t)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 22. Класс RemoveTripCommand

Данный класс представляет команду удаления рейса из системы. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Trip> trip` – указатель на удаляемый рейс;
- `int tripId` – идентификатор удаляемого рейса;

**Методы:**

- `RemoveTripCommand(TransportSystem* sys, int id)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 23. Класс AddVehicleCommand

Данный класс представляет команду добавления транспортного средства в систему. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Vehicle> vehicle` – указатель на добавляемое транспортное средство;

**Методы:**

- `AddVehicleCommand(TransportSystem* sys, shared_ptr<Vehicle> v)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 24. Класс RemoveVehicleCommand

Данный класс представляет команду удаления транспортного средства из системы. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Vehicle> vehicle` – указатель на удаляемое транспортное средство;
- `string licensePlate` – государственный номер удаляемого транспортного средства;

**Методы:**

- `RemoveVehicleCommand(TransportSystem* sys, const string& lp)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 25. Класс AddStopCommand

Данный класс представляет команду добавления остановки в систему. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `Stop stop` – добавляемая остановка;

**Методы:**

- `AddStopCommand(TransportSystem* sys, const Stop& s)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 26. Класс RemoveStopCommand

Данный класс представляет команду удаления остановки из системы. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `Stop stop` – удаляемая остановка;
- `int stopId` – идентификатор удаляемой остановки;

**Методы:**

- `RemoveStopCommand(TransportSystem* sys, int id)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 27. Класс AddDriverCommand

Данный класс представляет команду добавления водителя в систему. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Driver> driver` – указатель на добавляемого водителя;

**Методы:**

- `AddDriverCommand(TransportSystem* sys, shared_ptr<Driver> d)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

### 28. Класс RemoveDriverCommand

Данный класс представляет команду удаления водителя из системы. Наследуется от класса Command.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;
- `shared_ptr<Driver> driver` – указатель на удаляемого водителя;
- `string firstName, lastName, middleName` – поля для хранения имени, фамилии и отчества удаляемого водителя;

**Методы:**

- `RemoveDriverCommand(TransportSystem* sys, shared_ptr<Driver> d)` – конструктор с параметрами;
- `void execute() override` – переопределенный метод выполнения команды;
- `void undo() override` – переопределенный метод отмены команды;
- `string getDescription() const override` – переопределенный метод получения описания команды;

---

## Классы исключений

### 29. Класс TransportException

Данный класс представляет базовое пользовательское исключение в системе управления общественным транспортом. Наследуется от стандартного класса exception и предоставляет расширенный функционал для обработки ошибок.

**Поля:**

- `string message` – поле для хранения текстового сообщения об ошибке;

**Методы:**

- `explicit TransportException(const string& msg)` – конструктор с параметром сообщения об ошибке;
- `virtual ~TransportException()` – виртуальный деструктор;
- `const char* what() const noexcept override` – переопределенный метод из базового класса exception для получения C-строки с описанием ошибки;

---

### 30. Класс InputException

Данный класс представляет специализированное исключение для обработки ошибок, связанных с вводом данных в системе. Наследуется от базового класса TransportException.

**Методы:**

- `explicit InputException(const string& msg)` – конструктор с параметром сообщения об ошибке;

---

### 31. Класс FileException

Данный класс представляет специализированное исключение для обработки ошибок, связанных с операциями файлового ввода-вывода в системе. Наследуется от базового класса TransportException.

**Методы:**

- `explicit FileException(const string& filename, const string& operation = "операция")` – конструктор с параметрами имени файла и операции;
- `explicit FileException(const string& msg)` – конструктор с параметром сообщения об ошибке;

---

### 32. Класс ContainerException

Данный класс представляет специализированное исключение для обработки ошибок, связанных с работой контейнеров в системе. Наследуется от базового класса TransportException.

**Методы:**

- `explicit ContainerException(const string& msg)` – конструктор с параметром сообщения об ошибке;

---

## Классы алгоритмов

### 33. Класс Algorithm

Данный класс представляет базовый класс для всех алгоритмов в системе. Обеспечивает общий интерфейс для выполнения алгоритмов и получения их описаний. Используется для реализации паттерна Strategy.

**Поля:**

- `TransportSystem* system` – указатель на систему транспорта;

**Методы:**

- `explicit Algorithm(TransportSystem* sys)` – конструктор с параметром;
- `virtual ~Algorithm()` – виртуальный деструктор;
- `virtual void execute() = 0` – чистая виртуальная функция выполнения алгоритма;
- `virtual string getDescription() const = 0` – чистая виртуальная функция получения описания алгоритма;
- `void setSystem(TransportSystem* sys)` – метод установки системы транспорта;

---

### 34. Класс PathFindingAlgorithm

Данный класс представляет базовый класс для алгоритмов поиска пути в системе. Наследуется от класса Algorithm и предоставляет интерфейс для поиска маршрутов между остановками.

**Методы:**

- `explicit PathFindingAlgorithm(TransportSystem* sys)` – конструктор с параметром;
- `virtual vector<Journey> findPath(const string& start, const string& end, const Time& departureTime) = 0` – чистая виртуальная функция поиска пути;
- `void execute() override` – переопределенный метод выполнения (пустая реализация);

---

### 35. Класс BFSAlgorithm

Данный класс представляет алгоритм поиска в ширину (BFS) для поиска маршрутов с пересадками. Наследуется от класса PathFindingAlgorithm.

**Поля:**

- `int maxTransfers` – поле для хранения максимального количества пересадок;

**Методы:**

- `BFSAlgorithm(TransportSystem* sys, int maxTransfers = 2)` – конструктор с параметрами;
- `vector<Journey> findPath(const string& start, const string& end, const Time& departureTime) override` – переопределенный метод поиска пути;
- `void execute() override` – переопределенный метод выполнения;
- `string getDescription() const override` – переопределенный метод получения описания алгоритма;

---

### 36. Класс FastestPathAlgorithm

Данный класс представляет алгоритм поиска самого быстрого маршрута между остановками. Наследуется от класса PathFindingAlgorithm.

**Методы:**

- `explicit FastestPathAlgorithm(TransportSystem* sys)` – конструктор с параметром;
- `vector<Journey> findPath(const string& start, const string& end, const Time& departureTime) override` – переопределенный метод поиска пути;
- `void execute() override` – переопределенный метод выполнения;
- `string getDescription() const override` – переопределенный метод получения описания алгоритма;

---

### 37. Класс MinimalTransfersAlgorithm

Данный класс представляет алгоритм поиска маршрута с минимальным количеством пересадок между остановками. Наследуется от класса PathFindingAlgorithm.

**Методы:**

- `explicit MinimalTransfersAlgorithm(TransportSystem* sys)` – конструктор с параметром;
- `vector<Journey> findPath(const string& start, const string& end, const Time& departureTime) override` – переопределенный метод поиска пути;
- `void execute() override` – переопределенный метод выполнения;
- `string getDescription() const override` – переопределенный метод получения описания алгоритма;

---

### 38. Класс ArrivalTimeCalculationAlgorithm

Данный класс представляет алгоритм расчета времени прибытия на остановки для рейса. Наследуется от класса Algorithm.

**Методы:**

- `explicit ArrivalTimeCalculationAlgorithm(TransportSystem* sys)` – конструктор с параметром;
- `void calculateArrivalTimes(int tripId, double averageSpeed)` – метод расчета времени прибытия;
- `void execute() override` – переопределенный метод выполнения;
- `string getDescription() const override` – переопределенный метод получения описания алгоритма;

---

### 39. Класс RouteSearchAlgorithm

Данный класс представляет алгоритм поиска маршрутов между остановками. Наследуется от класса Algorithm.

**Методы:**

- `explicit RouteSearchAlgorithm(TransportSystem* sys)` – конструктор с параметром;
- `vector<shared_ptr<Route>> findRoutes(const string& stopA, const string& stopB)` – метод поиска маршрутов между двумя остановками;
- `void execute() override` – переопределенный метод выполнения;
- `string getDescription() const override` – переопределенный метод получения описания алгоритма;

---

## Классы контейнеров

### 40. Класс DynamicArray

Данный класс представляет реализацию динамического массива. Является шаблонным контейнером для хранения и управления последовательностью элементов произвольного типа. Обеспечивает эффективные операции добавления и удаления элементов, а также поддержку итераторов.

**Поля:**

- `T* data` – указатель на массив данных;
- `size_t capacity` – поле для хранения емкости массива;
- `size_t size_` – поле для хранения текущего размера массива;

**Методы:**

- `DynamicArray()` – конструктор по умолчанию;
- `explicit DynamicArray(size_t initialSize)` – конструктор с начальным размером;
- `DynamicArray(const DynamicArray& other)` – конструктор копирования;
- `DynamicArray& operator=(const DynamicArray& other)` – перегрузка оператора присваивания;
- `~DynamicArray()` – деструктор;
- `void push_back(const T& value)` – метод добавления элемента в конец массива;
- `void push_back(T&& value)` – метод добавления элемента в конец массива (перемещение);
- `void erase(const Iterator& it)` – метод удаления элемента по итератору;
- `void erase(const Iterator& first, const Iterator& last)` – метод удаления диапазона элементов;
- `T& operator[](size_t index)` – перегрузка оператора доступа по индексу;
- `const T& operator[](size_t index) const` – константная версия оператора доступа по индексу;
- `T& front()` – метод получения первого элемента;
- `const T& front() const` – константная версия метода получения первого элемента;
- `T& back()` – метод получения последнего элемента;
- `const T& back() const` – константная версия метода получения последнего элемента;
- `size_t size() const` – метод получения размера массива;
- `bool empty() const` – метод проверки массива на пустоту;
- `void clear()` – метод очистки массива;
- `Iterator begin()` – метод получения итератора на начало массива;
- `Iterator end()` – метод получения итератора на конец массива;
- `Iterator begin() const` – константная версия метода получения итератора на начало;
- `Iterator end() const` – константная версия метода получения итератора на конец;

**Приватные методы:**

- `void resize()` – метод увеличения емкости массива;

**Вложенный класс Iterator:**

- `Iterator(T* p)` – конструктор итератора;
- `T& operator*()` – оператор разыменования, возвращает ссылку на данные;
- `const T& operator*() const` – константная версия оператора разыменования;
- `T* operator->()` – оператор доступа к членам через указатель;
- `const T* operator->() const` – константная версия оператора доступа;
- `Iterator& operator++()` – оператор пре-инкремента;
- `Iterator operator++(int)` – оператор пост-инкремента;
- `Iterator& operator--()` – оператор пре-декремента;
- `Iterator operator--(int)` – оператор пост-декремента;
- `bool operator==(const Iterator& other) const` – оператор проверки равенства;
- `bool operator!=(const Iterator& other) const` – оператор проверки неравенства;
- `Iterator operator+(int n) const` – оператор сложения итератора с числом;
- `Iterator operator-(int n) const` – оператор вычитания числа из итератора;
- `friend Iterator operator+(int n, const Iterator& it)` – дружественная функция сложения числа с итератором;
- `friend int operator-(const Iterator& a, const Iterator& b)` – дружественная функция вычитания итераторов;
- `bool operator<(const Iterator& other) const` – оператор сравнения меньше;
- `bool operator>(const Iterator& other) const` – оператор сравнения больше;
- `bool operator<=(const Iterator& other) const` – оператор сравнения меньше или равно;
- `bool operator>=(const Iterator& other) const` – оператор сравнения больше или равно;
- `Iterator& operator+=(int n)` – оператор сложения с присваиванием;
- `Iterator& operator-=(int n)` – оператор вычитания с присваиванием;
- `T& operator[](int n)` – оператор доступа по индексу через итератор;
- `const T& operator[](int n) const` – константная версия оператора доступа по индексу;

